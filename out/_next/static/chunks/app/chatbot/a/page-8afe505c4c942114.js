(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[210],{198:(e,t,n)=>{"use strict";let a,r;n.d(t,{P2:()=>_});let s=(e,t)=>t.some(t=>e instanceof t),o=new WeakMap,i=new WeakMap,c=new WeakMap,u={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return o.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return l(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function l(e){if(e instanceof IDBRequest){let t=new Promise((t,n)=>{let a=()=>{e.removeEventListener("success",r),e.removeEventListener("error",s)},r=()=>{t(l(e.result)),a()},s=()=>{n(e.error),a()};e.addEventListener("success",r),e.addEventListener("error",s)});return c.set(t,e),t}if(i.has(e))return i.get(e);let t=function(e){if("function"==typeof e)return(r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(d(this),t),l(this.request)}:function(...t){return l(e.apply(d(this),t))};return(e instanceof IDBTransaction&&function(e){if(o.has(e))return;let t=new Promise((t,n)=>{let a=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",s),e.removeEventListener("abort",s)},r=()=>{t(),a()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),a()};e.addEventListener("complete",r),e.addEventListener("error",s),e.addEventListener("abort",s)});o.set(e,t)}(e),s(e,a||(a=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(e,u):e}(e);return t!==e&&(i.set(e,t),c.set(t,e)),t}let d=e=>c.get(e);function _(e,t,{blocked:n,upgrade:a,blocking:r,terminated:s}={}){let o=indexedDB.open(e,t),i=l(o);return a&&o.addEventListener("upgradeneeded",e=>{a(l(o.result),e.oldVersion,e.newVersion,l(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),i.then(e=>{s&&e.addEventListener("close",()=>s()),r&&e.addEventListener("versionchange",e=>r(e.oldVersion,e.newVersion,e))}).catch(()=>{}),i}let h=["get","getKey","getAll","getAllKeys","count"],b=["put","add","delete","clear"],p=new Map;function m(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(p.get(t))return p.get(t);let n=t.replace(/FromIndex$/,""),a=t!==n,r=b.includes(n);if(!(n in(a?IDBIndex:IDBObjectStore).prototype)||!(r||h.includes(n)))return;let s=async function(e,...t){let s=this.transaction(e,r?"readwrite":"readonly"),o=s.store;return a&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),r&&s.done]))[0]};return p.set(t,s),s}u=(e=>({...e,get:(t,n,a)=>m(t,n)||e.get(t,n,a),has:(t,n)=>!!m(t,n)||e.has(t,n)}))(u);let f=["continue","continuePrimaryKey","advance"],v={},w=new WeakMap,g=new WeakMap,y={get(e,t){if(!f.includes(t))return e[t];let n=v[t];return n||(n=v[t]=function(...e){w.set(this,g.get(this)[t](...e))}),n}};async function*B(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;let n=new Proxy(t,y);for(g.set(n,t),c.set(n,d(t));t;)yield n,t=await (w.get(n)||t.continue()),w.delete(n)}function I(e,t){return t===Symbol.asyncIterator&&s(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&s(e,[IDBIndex,IDBObjectStore])}u=(e=>({...e,get:(t,n,a)=>I(t,n)?B:e.get(t,n,a),has:(t,n)=>I(t,n)||e.has(t,n)}))(u)},3977:(e,t,n)=>{Promise.resolve().then(n.bind(n,9287))},4706:(e,t,n)=>{"use strict";n.d(t,{Gt:()=>i,QX:()=>l,QY:()=>c,jw:()=>o,zX:()=>u});var a=n(198);let r="histories";async function s(){return(0,a.P2)("feldman_chat_db",1,{upgrade(e){e.objectStoreNames.contains(r)||e.createObjectStore(r,{keyPath:"id",autoIncrement:!0})}})}async function o(e){let t=await s(),n=new Date().toLocaleString();await t.add(r,{title:"새 ".concat(e.toUpperCase()," 대화 (").concat(n,")"),messages:[],type:e,createdAt:n})}async function i(e,t){let n=await s(),a=await n.get(r,e);a&&(a.title=t,await n.put(r,a))}async function c(){let e=await s();return await e.getAll(r)}async function u(e){let t=await s();return await t.get(r,e)}async function l(e,t,n){let a=await s(),o=new Date().toLocaleString();await a.add(r,{title:e||"대화 (".concat(o,")"),messages:t,type:n,createdAt:o})}},5695:(e,t,n)=>{"use strict";var a=n(8999);n.o(a,"usePathname")&&n.d(t,{usePathname:function(){return a.usePathname}}),n.o(a,"useRouter")&&n.d(t,{useRouter:function(){return a.useRouter}}),n.o(a,"useSearchParams")&&n.d(t,{useSearchParams:function(){return a.useSearchParams}})},8565:e=>{e.exports={layout:"chatbot_layout__tt6Yv",sidebarWrapper:"chatbot_sidebarWrapper__BZ9S9",open:"chatbot_open__aAxWk",sidebarToggle:"chatbot_sidebarToggle__TFyUC",sidebarHeader:"chatbot_sidebarHeader__kXtPL",homeBtn:"chatbot_homeBtn__IvHR_",newSessionBtn:"chatbot_newSessionBtn__xXWHs",sessionList:"chatbot_sessionList__UUOwZ",sessionItem:"chatbot_sessionItem__DvGxH",sessionLink:"chatbot_sessionLink__NmtSE",sessionInput:"chatbot_sessionInput__3UYvc",editBtn:"chatbot_editBtn__2owYW",title:"chatbot_title__uiKgD",chat:"chatbot_chat__Yb4t2",chatBox:"chatbot_chatBox__k7xrM",messageRow:"chatbot_messageRow__1_4v3",left:"chatbot_left__hHdSl",right:"chatbot_right__5DjCX",bubbleAssistant:"chatbot_bubbleAssistant__NY2B5",bubbleUser:"chatbot_bubbleUser__mo7Ss",form:"chatbot_form__ZMP6s",input:"chatbot_input__CgOcK",button:"chatbot_button__vs6lv",disabled:"chatbot_disabled__GHIW2",tip:"chatbot_tip__3_A0a",saveBtnFixed:"chatbot_saveBtnFixed__ypo9G",chatImage:"chatbot_chatImage__G1Uli",previewBox:"chatbot_previewBox__Yu0DP",previewImage:"chatbot_previewImage__L7B5e",attachBtn:"chatbot_attachBtn__sSjAC"}},9287:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>d});var a=n(5155),r=n(2115),s=n(5695),o=n(4706),i=n(8565),c=n.n(i);let u=["안녕하세요! 펠드만 비평(설명→분석→해석→판단)으로 작품 감상을 시작해볼게요. 가장 먼저 1단계, 묘사(Description)입니다. 연구원에게 안내받은 작품을 한 문장으로 묘사해 주세요.","2단계, 분석(Analysis) 단계입니다. 작품을 분석해 보세요.","3단계, 해석(Interpretation) 단계입니다. 작품을 해석해 보세요.","마지막! 4단계, 판단(Judgement) 단계입니다. 지금까지의 답변을 바탕으로 작품에 대해 판단해 보세요.","고생하셨습니다, 이제 챗봇 사용 경험에 대해 연구원이 몇가지 질문드릴 건데 답해주시면 됩니다. "];function l(){let e=(0,s.useSearchParams)().get("history"),[t,n]=(0,r.useState)(1),[i,l]=(0,r.useState)([{role:"assistant",content:u[0]}]),[d,_]=(0,r.useState)("");(0,r.useEffect)(()=>{e&&(async()=>{let t=await (0,o.zX)(Number(e));t&&l(t.messages)})()},[e]);let h=async()=>{await (0,o.QX)("A타입 대화",i,"a"),window.dispatchEvent(new Event("history-saved"));let e=new Blob([i.map(e=>"[".concat(e.role,"] ").concat(e.content)).join("\n\n")],{type:"text/plain"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="chat-history-a.txt",n.click(),URL.revokeObjectURL(t),alert("채팅 기록이 저장되고, 파일이 다운로드되었습니다 ✅")};return(0,a.jsxs)("main",{className:c().chat,style:{position:"relative"},children:[(0,a.jsx)("h1",{className:c().title,children:"Type A Chatbot"}),(0,a.jsx)("button",{onClick:h,className:c().saveBtnFixed,children:"채팅 기록 저장"}),(0,a.jsx)("div",{className:c().chatBox,children:i.map((e,t)=>(0,a.jsx)("div",{className:"".concat(c().messageRow," ").concat("user"===e.role?c().right:c().left),children:(0,a.jsx)("div",{className:"user"===e.role?c().bubbleUser:c().bubbleAssistant,children:e.content})},t))}),t<u.length&&(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),d.trim()&&(l([...i,{role:"user",content:d.trim()},{role:"assistant",content:u[t]}]),_(""),n(t+1))},className:c().form,children:[(0,a.jsx)("input",{value:d,onChange:e=>_(e.target.value),placeholder:"답변을 입력하세요...",className:c().input}),(0,a.jsx)("button",{className:c().button,children:"보내기"})]})]})}function d(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)("div",{children:"로딩 중..."}),children:(0,a.jsx)(l,{})})}}},e=>{e.O(0,[414,441,964,358],()=>e(e.s=3977)),_N_E=e.O()}]);